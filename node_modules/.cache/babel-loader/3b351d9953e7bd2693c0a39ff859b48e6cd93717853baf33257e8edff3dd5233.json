{"ast":null,"code":"import React,{useContext,useEffect,useRef}from'react';import{Navigate,useNavigate}from'react-router-dom';import{AuthContext}from'../context/AuthContext';import{jsx as _jsx}from\"react/jsx-runtime\";const ProtectedRoute=_ref=>{let{children}=_ref;const{user,loading,logout}=useContext(AuthContext);const navigate=useNavigate();const timeoutRef=useRef(null);const lastActivityRef=useRef(Date.now());useEffect(()=>{if(!user)return;// Activity tracking functions\nconst updateActivity=()=>{lastActivityRef.current=Date.now();};const checkInactivity=()=>{const now=Date.now();const timeSinceLastActivity=now-lastActivityRef.current;const oneMinute=60*1000;// 1 minute in milliseconds\nif(timeSinceLastActivity>=oneMinute){// Auto logout after 1 minute of inactivity\nlogout();navigate('/admin/login',{replace:true});alert('You have been logged out due to inactivity.');}};// Track user activity events\nconst events=['mousedown','mousemove','keypress','scroll','touchstart','click'];events.forEach(event=>{document.addEventListener(event,updateActivity,true);});// Check inactivity every 10 seconds\nconst interval=setInterval(checkInactivity,10000);// Cleanup\nreturn()=>{events.forEach(event=>{document.removeEventListener(event,updateActivity,true);});clearInterval(interval);if(timeoutRef.current){clearTimeout(timeoutRef.current);}};},[user,logout,navigate]);if(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"min-h-screen flex items-center justify-center\",children:/*#__PURE__*/_jsx(\"div\",{className:\"text-reshow-dark\",children:\"Loading...\"})});}if(!user){return/*#__PURE__*/_jsx(Navigate,{to:\"/admin/login\",replace:true});}return children;};export default ProtectedRoute;","map":{"version":3,"names":["React","useContext","useEffect","useRef","Navigate","useNavigate","AuthContext","jsx","_jsx","ProtectedRoute","_ref","children","user","loading","logout","navigate","timeoutRef","lastActivityRef","Date","now","updateActivity","current","checkInactivity","timeSinceLastActivity","oneMinute","replace","alert","events","forEach","event","document","addEventListener","interval","setInterval","removeEventListener","clearInterval","clearTimeout","className","to"],"sources":["C:/Users/Liyandah/Desktop/reshow/client/src/components/ProtectedRoute.js"],"sourcesContent":["import React, { useContext, useEffect, useRef } from 'react';\r\nimport { Navigate, useNavigate } from 'react-router-dom';\r\nimport { AuthContext } from '../context/AuthContext';\r\n\r\nconst ProtectedRoute = ({ children }) => {\r\n  const { user, loading, logout } = useContext(AuthContext);\r\n  const navigate = useNavigate();\r\n  const timeoutRef = useRef(null);\r\n  const lastActivityRef = useRef(Date.now());\r\n\r\n\r\n  useEffect(() => {\r\n    if (!user) return;\r\n\r\n    // Activity tracking functions\r\n    const updateActivity = () => {\r\n      lastActivityRef.current = Date.now();\r\n    };\r\n\r\n    const checkInactivity = () => {\r\n      const now = Date.now();\r\n      const timeSinceLastActivity = now - lastActivityRef.current;\r\n      const oneMinute = 60 * 1000; // 1 minute in milliseconds\r\n\r\n      if (timeSinceLastActivity >= oneMinute) {\r\n        // Auto logout after 1 minute of inactivity\r\n        logout();\r\n        navigate('/admin/login', { replace: true });\r\n        alert('You have been logged out due to inactivity.');\r\n      }\r\n    };\r\n\r\n    // Track user activity events\r\n    const events = ['mousedown', 'mousemove', 'keypress', 'scroll', 'touchstart', 'click'];\r\n    events.forEach(event => {\r\n      document.addEventListener(event, updateActivity, true);\r\n    });\r\n\r\n    // Check inactivity every 10 seconds\r\n    const interval = setInterval(checkInactivity, 10000);\r\n\r\n    // Cleanup\r\n    return () => {\r\n      events.forEach(event => {\r\n        document.removeEventListener(event, updateActivity, true);\r\n      });\r\n      clearInterval(interval);\r\n      if (timeoutRef.current) {\r\n        clearTimeout(timeoutRef.current);\r\n      }\r\n    };\r\n  }, [user, logout, navigate]);\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"min-h-screen flex items-center justify-center\">\r\n        <div className=\"text-reshow-dark\">Loading...</div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (!user) {\r\n    return <Navigate to=\"/admin/login\" replace />;\r\n  }\r\n\r\n  return children;\r\n};\r\n\r\nexport default ProtectedRoute;\r\n\r\n"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,UAAU,CAAEC,SAAS,CAAEC,MAAM,KAAQ,OAAO,CAC5D,OAASC,QAAQ,CAAEC,WAAW,KAAQ,kBAAkB,CACxD,OAASC,WAAW,KAAQ,wBAAwB,CAAC,OAAAC,GAAA,IAAAC,IAAA,yBAErD,KAAM,CAAAC,cAAc,CAAGC,IAAA,EAAkB,IAAjB,CAAEC,QAAS,CAAC,CAAAD,IAAA,CAClC,KAAM,CAAEE,IAAI,CAAEC,OAAO,CAAEC,MAAO,CAAC,CAAGb,UAAU,CAACK,WAAW,CAAC,CACzD,KAAM,CAAAS,QAAQ,CAAGV,WAAW,CAAC,CAAC,CAC9B,KAAM,CAAAW,UAAU,CAAGb,MAAM,CAAC,IAAI,CAAC,CAC/B,KAAM,CAAAc,eAAe,CAAGd,MAAM,CAACe,IAAI,CAACC,GAAG,CAAC,CAAC,CAAC,CAG1CjB,SAAS,CAAC,IAAM,CACd,GAAI,CAACU,IAAI,CAAE,OAEX;AACA,KAAM,CAAAQ,cAAc,CAAGA,CAAA,GAAM,CAC3BH,eAAe,CAACI,OAAO,CAAGH,IAAI,CAACC,GAAG,CAAC,CAAC,CACtC,CAAC,CAED,KAAM,CAAAG,eAAe,CAAGA,CAAA,GAAM,CAC5B,KAAM,CAAAH,GAAG,CAAGD,IAAI,CAACC,GAAG,CAAC,CAAC,CACtB,KAAM,CAAAI,qBAAqB,CAAGJ,GAAG,CAAGF,eAAe,CAACI,OAAO,CAC3D,KAAM,CAAAG,SAAS,CAAG,EAAE,CAAG,IAAI,CAAE;AAE7B,GAAID,qBAAqB,EAAIC,SAAS,CAAE,CACtC;AACAV,MAAM,CAAC,CAAC,CACRC,QAAQ,CAAC,cAAc,CAAE,CAAEU,OAAO,CAAE,IAAK,CAAC,CAAC,CAC3CC,KAAK,CAAC,6CAA6C,CAAC,CACtD,CACF,CAAC,CAED;AACA,KAAM,CAAAC,MAAM,CAAG,CAAC,WAAW,CAAE,WAAW,CAAE,UAAU,CAAE,QAAQ,CAAE,YAAY,CAAE,OAAO,CAAC,CACtFA,MAAM,CAACC,OAAO,CAACC,KAAK,EAAI,CACtBC,QAAQ,CAACC,gBAAgB,CAACF,KAAK,CAAET,cAAc,CAAE,IAAI,CAAC,CACxD,CAAC,CAAC,CAEF;AACA,KAAM,CAAAY,QAAQ,CAAGC,WAAW,CAACX,eAAe,CAAE,KAAK,CAAC,CAEpD;AACA,MAAO,IAAM,CACXK,MAAM,CAACC,OAAO,CAACC,KAAK,EAAI,CACtBC,QAAQ,CAACI,mBAAmB,CAACL,KAAK,CAAET,cAAc,CAAE,IAAI,CAAC,CAC3D,CAAC,CAAC,CACFe,aAAa,CAACH,QAAQ,CAAC,CACvB,GAAIhB,UAAU,CAACK,OAAO,CAAE,CACtBe,YAAY,CAACpB,UAAU,CAACK,OAAO,CAAC,CAClC,CACF,CAAC,CACH,CAAC,CAAE,CAACT,IAAI,CAAEE,MAAM,CAAEC,QAAQ,CAAC,CAAC,CAE5B,GAAIF,OAAO,CAAE,CACX,mBACEL,IAAA,QAAK6B,SAAS,CAAC,+CAA+C,CAAA1B,QAAA,cAC5DH,IAAA,QAAK6B,SAAS,CAAC,kBAAkB,CAAA1B,QAAA,CAAC,YAAU,CAAK,CAAC,CAC/C,CAAC,CAEV,CAEA,GAAI,CAACC,IAAI,CAAE,CACT,mBAAOJ,IAAA,CAACJ,QAAQ,EAACkC,EAAE,CAAC,cAAc,CAACb,OAAO,MAAE,CAAC,CAC/C,CAEA,MAAO,CAAAd,QAAQ,CACjB,CAAC,CAED,cAAe,CAAAF,cAAc","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}