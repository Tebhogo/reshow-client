{"ast":null,"code":"import React,{useState,useRef}from'react';import api from'../utils/api';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const ImageUpload=_ref=>{let{currentImage,onImageChange,label='Upload Image'}=_ref;const[uploading,setUploading]=useState(false);const[preview,setPreview]=useState(null);const fileInputRef=useRef(null);const inputId=useRef(\"image-upload-\".concat(Date.now(),\"-\").concat(Math.random().toString(36).substr(2,9)));const handleFileChange=async e=>{const file=e.target.files[0];if(!file)return;// Show preview\nconst reader=new FileReader();reader.onloadend=()=>{setPreview(reader.result);};reader.readAsDataURL(file);// Upload to server\nsetUploading(true);try{// Use admin upload endpoint for content management\nconst uploadFormData=new FormData();uploadFormData.append('image',file);uploadFormData.append('uploadType','content');console.log('Uploading image:',file.name,'Size:',file.size,'Type:',file.type);// Axios will automatically handle Content-Type for FormData (interceptor removes default header)\nconst res=await api.post('/admin/upload',uploadFormData);if(res.data&&res.data.url){onImageChange(res.data.url);// Clear the file input so the same file can be uploaded again if needed\nif(fileInputRef.current){fileInputRef.current.value='';}}else{throw new Error('No URL in response');}}catch(error){var _error$response,_error$response2,_error$response3,_error$response3$data,_error$response4,_error$response5;console.error('Image upload error:',error);console.error('Error response:',(_error$response=error.response)===null||_error$response===void 0?void 0:_error$response.data);console.error('Error status:',(_error$response2=error.response)===null||_error$response2===void 0?void 0:_error$response2.status);console.error('Error message:',error.message);let errorMessage='Failed to upload image. Please try again.';if((_error$response3=error.response)!==null&&_error$response3!==void 0&&(_error$response3$data=_error$response3.data)!==null&&_error$response3$data!==void 0&&_error$response3$data.error){errorMessage=error.response.data.error;}else if(((_error$response4=error.response)===null||_error$response4===void 0?void 0:_error$response4.status)===401){errorMessage='Authentication failed. Please log in again.';}else if(((_error$response5=error.response)===null||_error$response5===void 0?void 0:_error$response5.status)===400){var _error$response$data;errorMessage=((_error$response$data=error.response.data)===null||_error$response$data===void 0?void 0:_error$response$data.error)||'Invalid file. Please check the file size and format.';}else if(error.message){errorMessage=error.message;}alert(errorMessage);setPreview(null);// Clear preview on error\n}finally{setUploading(false);}};return/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-2\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"block font-dosis font-semibold\",children:label}),/*#__PURE__*/_jsxs(\"div\",{className:\"border-2 border-dashed border-gray-300 rounded-lg p-4 text-center\",children:[(preview||currentImage)&&/*#__PURE__*/_jsx(\"img\",{src:preview||currentImage,alt:\"Preview\",className:\"max-w-full h-48 object-cover mx-auto mb-2 rounded\"}),/*#__PURE__*/_jsx(\"input\",{ref:fileInputRef,type:\"file\",accept:\"image/*\",onChange:handleFileChange,disabled:uploading,className:\"hidden\",id:inputId.current}),/*#__PURE__*/_jsx(\"label\",{htmlFor:inputId.current,className:\"cursor-pointer inline-block px-4 py-2 rounded-lg font-dosis font-semibold transition-colors \".concat(uploading?'bg-gray-400 text-white cursor-not-allowed':'bg-reshow-red text-white hover:bg-reshow-dark-red'),children:uploading?'Uploading...':preview||currentImage?'Change Image':'Choose Image'})]})]});};export default ImageUpload;","map":{"version":3,"names":["React","useState","useRef","api","jsx","_jsx","jsxs","_jsxs","ImageUpload","_ref","currentImage","onImageChange","label","uploading","setUploading","preview","setPreview","fileInputRef","inputId","concat","Date","now","Math","random","toString","substr","handleFileChange","e","file","target","files","reader","FileReader","onloadend","result","readAsDataURL","uploadFormData","FormData","append","console","log","name","size","type","res","post","data","url","current","value","Error","error","_error$response","_error$response2","_error$response3","_error$response3$data","_error$response4","_error$response5","response","status","message","errorMessage","_error$response$data","alert","className","children","src","alt","ref","accept","onChange","disabled","id","htmlFor"],"sources":["C:/Users/Liyandah/Desktop/reshow/client/src/components/ImageUpload.js"],"sourcesContent":["import React, { useState, useRef } from 'react';\nimport api from '../utils/api';\n\nconst ImageUpload = ({ currentImage, onImageChange, label = 'Upload Image' }) => {\n  const [uploading, setUploading] = useState(false);\n  const [preview, setPreview] = useState(null);\n  const fileInputRef = useRef(null);\n  const inputId = useRef(`image-upload-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`);\n\n  const handleFileChange = async (e) => {\n    const file = e.target.files[0];\n    if (!file) return;\n\n    // Show preview\n    const reader = new FileReader();\n    reader.onloadend = () => {\n      setPreview(reader.result);\n    };\n    reader.readAsDataURL(file);\n\n    // Upload to server\n    setUploading(true);\n\n    try {\n      // Use admin upload endpoint for content management\n      const uploadFormData = new FormData();\n      uploadFormData.append('image', file);\n      uploadFormData.append('uploadType', 'content');\n      \n      console.log('Uploading image:', file.name, 'Size:', file.size, 'Type:', file.type);\n      \n      // Axios will automatically handle Content-Type for FormData (interceptor removes default header)\n      const res = await api.post('/admin/upload', uploadFormData);\n      \n      if (res.data && res.data.url) {\n        onImageChange(res.data.url);\n        // Clear the file input so the same file can be uploaded again if needed\n        if (fileInputRef.current) {\n          fileInputRef.current.value = '';\n        }\n      } else {\n        throw new Error('No URL in response');\n      }\n    } catch (error) {\n      console.error('Image upload error:', error);\n      console.error('Error response:', error.response?.data);\n      console.error('Error status:', error.response?.status);\n      console.error('Error message:', error.message);\n      \n      let errorMessage = 'Failed to upload image. Please try again.';\n      if (error.response?.data?.error) {\n        errorMessage = error.response.data.error;\n      } else if (error.response?.status === 401) {\n        errorMessage = 'Authentication failed. Please log in again.';\n      } else if (error.response?.status === 400) {\n        errorMessage = error.response.data?.error || 'Invalid file. Please check the file size and format.';\n      } else if (error.message) {\n        errorMessage = error.message;\n      }\n      \n      alert(errorMessage);\n      setPreview(null); // Clear preview on error\n    } finally {\n      setUploading(false);\n    }\n  };\n\n  return (\n    <div className=\"space-y-2\">\n      <label className=\"block font-dosis font-semibold\">{label}</label>\n      <div className=\"border-2 border-dashed border-gray-300 rounded-lg p-4 text-center\">\n        {(preview || currentImage) && (\n          <img\n            src={preview || currentImage}\n            alt=\"Preview\"\n            className=\"max-w-full h-48 object-cover mx-auto mb-2 rounded\"\n          />\n        )}\n        <input\n          ref={fileInputRef}\n          type=\"file\"\n          accept=\"image/*\"\n          onChange={handleFileChange}\n          disabled={uploading}\n          className=\"hidden\"\n          id={inputId.current}\n        />\n        <label\n          htmlFor={inputId.current}\n          className={`cursor-pointer inline-block px-4 py-2 rounded-lg font-dosis font-semibold transition-colors ${\n            uploading\n              ? 'bg-gray-400 text-white cursor-not-allowed'\n              : 'bg-reshow-red text-white hover:bg-reshow-dark-red'\n          }`}\n        >\n          {uploading ? 'Uploading...' : preview || currentImage ? 'Change Image' : 'Choose Image'}\n        </label>\n      </div>\n    </div>\n  );\n};\n\nexport default ImageUpload;\n\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}