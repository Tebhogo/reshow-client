{"ast":null,"code":"var _jsxFileName = \"C:\\\\Liyanda project\\\\reshow\\\\client\\\\src\\\\components\\\\ImageUpload.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useRef } from 'react';\nimport api from '../utils/api';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst ImageUpload = ({\n  currentImage,\n  onImageChange,\n  label = 'Upload Image'\n}) => {\n  _s();\n  const [uploading, setUploading] = useState(false);\n  const [preview, setPreview] = useState(null);\n  const fileInputRef = useRef(null);\n  const inputId = useRef(`image-upload-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`);\n  const handleFileChange = async e => {\n    const file = e.target.files[0];\n    if (!file) return;\n\n    // Show preview\n    const reader = new FileReader();\n    reader.onloadend = () => {\n      setPreview(reader.result);\n    };\n    reader.readAsDataURL(file);\n\n    // Upload to server\n    setUploading(true);\n    try {\n      // Use admin upload endpoint for content management\n      const uploadFormData = new FormData();\n      uploadFormData.append('image', file);\n      uploadFormData.append('uploadType', 'content');\n      console.log('Uploading image:', file.name, 'Size:', file.size, 'Type:', file.type);\n\n      // Axios will automatically handle Content-Type for FormData (interceptor removes default header)\n      const res = await api.post('/admin/upload', uploadFormData);\n      if (res.data && res.data.url) {\n        onImageChange(res.data.url);\n        // Clear the file input so the same file can be uploaded again if needed\n        if (fileInputRef.current) {\n          fileInputRef.current.value = '';\n        }\n      } else {\n        throw new Error('No URL in response');\n      }\n    } catch (error) {\n      var _error$response, _error$response2, _error$response3, _error$response3$data, _error$response4, _error$response5;\n      console.error('Image upload error:', error);\n      console.error('Error response:', (_error$response = error.response) === null || _error$response === void 0 ? void 0 : _error$response.data);\n      console.error('Error status:', (_error$response2 = error.response) === null || _error$response2 === void 0 ? void 0 : _error$response2.status);\n      console.error('Error message:', error.message);\n      let errorMessage = 'Failed to upload image. Please try again.';\n      if ((_error$response3 = error.response) !== null && _error$response3 !== void 0 && (_error$response3$data = _error$response3.data) !== null && _error$response3$data !== void 0 && _error$response3$data.error) {\n        errorMessage = error.response.data.error;\n      } else if (((_error$response4 = error.response) === null || _error$response4 === void 0 ? void 0 : _error$response4.status) === 401) {\n        errorMessage = 'Authentication failed. Please log in again.';\n      } else if (((_error$response5 = error.response) === null || _error$response5 === void 0 ? void 0 : _error$response5.status) === 400) {\n        var _error$response$data;\n        errorMessage = ((_error$response$data = error.response.data) === null || _error$response$data === void 0 ? void 0 : _error$response$data.error) || 'Invalid file. Please check the file size and format.';\n      } else if (error.message) {\n        errorMessage = error.message;\n      }\n      alert(errorMessage);\n      setPreview(null); // Clear preview on error\n    } finally {\n      setUploading(false);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"space-y-2\",\n    children: [/*#__PURE__*/_jsxDEV(\"label\", {\n      className: \"block font-dosis font-semibold\",\n      children: label\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"border-2 border-dashed border-gray-300 rounded-lg p-4 text-center\",\n      children: [(preview || currentImage) && /*#__PURE__*/_jsxDEV(\"img\", {\n        src: preview || currentImage,\n        alt: \"Preview\",\n        className: \"max-w-full h-48 object-cover mx-auto mb-2 rounded\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 73,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        ref: fileInputRef,\n        type: \"file\",\n        accept: \"image/*\",\n        onChange: handleFileChange,\n        disabled: uploading,\n        className: \"hidden\",\n        id: inputId.current\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 79,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n        htmlFor: inputId.current,\n        className: `cursor-pointer inline-block px-4 py-2 rounded-lg font-dosis font-semibold transition-colors ${uploading ? 'bg-gray-400 text-white cursor-not-allowed' : 'bg-reshow-red text-white hover:bg-reshow-dark-red'}`,\n        children: uploading ? 'Uploading...' : preview || currentImage ? 'Change Image' : 'Choose Image'\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 88,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 71,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 69,\n    columnNumber: 5\n  }, this);\n};\n_s(ImageUpload, \"9rXxYdqVIC/EPmurGB3fmSBi3Yc=\");\n_c = ImageUpload;\nexport default ImageUpload;\nvar _c;\n$RefreshReg$(_c, \"ImageUpload\");","map":{"version":3,"names":["React","useState","useRef","api","jsxDEV","_jsxDEV","ImageUpload","currentImage","onImageChange","label","_s","uploading","setUploading","preview","setPreview","fileInputRef","inputId","Date","now","Math","random","toString","substr","handleFileChange","e","file","target","files","reader","FileReader","onloadend","result","readAsDataURL","uploadFormData","FormData","append","console","log","name","size","type","res","post","data","url","current","value","Error","error","_error$response","_error$response2","_error$response3","_error$response3$data","_error$response4","_error$response5","response","status","message","errorMessage","_error$response$data","alert","className","children","fileName","_jsxFileName","lineNumber","columnNumber","src","alt","ref","accept","onChange","disabled","id","htmlFor","_c","$RefreshReg$"],"sources":["C:/Liyanda project/reshow/client/src/components/ImageUpload.js"],"sourcesContent":["import React, { useState, useRef } from 'react';\r\nimport api from '../utils/api';\r\n\r\nconst ImageUpload = ({ currentImage, onImageChange, label = 'Upload Image' }) => {\r\n  const [uploading, setUploading] = useState(false);\r\n  const [preview, setPreview] = useState(null);\r\n  const fileInputRef = useRef(null);\r\n  const inputId = useRef(`image-upload-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`);\r\n\r\n  const handleFileChange = async (e) => {\r\n    const file = e.target.files[0];\r\n    if (!file) return;\r\n\r\n    // Show preview\r\n    const reader = new FileReader();\r\n    reader.onloadend = () => {\r\n      setPreview(reader.result);\r\n    };\r\n    reader.readAsDataURL(file);\r\n\r\n    // Upload to server\r\n    setUploading(true);\r\n\r\n    try {\r\n      // Use admin upload endpoint for content management\r\n      const uploadFormData = new FormData();\r\n      uploadFormData.append('image', file);\r\n      uploadFormData.append('uploadType', 'content');\r\n      \r\n      console.log('Uploading image:', file.name, 'Size:', file.size, 'Type:', file.type);\r\n      \r\n      // Axios will automatically handle Content-Type for FormData (interceptor removes default header)\r\n      const res = await api.post('/admin/upload', uploadFormData);\r\n      \r\n      if (res.data && res.data.url) {\r\n        onImageChange(res.data.url);\r\n        // Clear the file input so the same file can be uploaded again if needed\r\n        if (fileInputRef.current) {\r\n          fileInputRef.current.value = '';\r\n        }\r\n      } else {\r\n        throw new Error('No URL in response');\r\n      }\r\n    } catch (error) {\r\n      console.error('Image upload error:', error);\r\n      console.error('Error response:', error.response?.data);\r\n      console.error('Error status:', error.response?.status);\r\n      console.error('Error message:', error.message);\r\n      \r\n      let errorMessage = 'Failed to upload image. Please try again.';\r\n      if (error.response?.data?.error) {\r\n        errorMessage = error.response.data.error;\r\n      } else if (error.response?.status === 401) {\r\n        errorMessage = 'Authentication failed. Please log in again.';\r\n      } else if (error.response?.status === 400) {\r\n        errorMessage = error.response.data?.error || 'Invalid file. Please check the file size and format.';\r\n      } else if (error.message) {\r\n        errorMessage = error.message;\r\n      }\r\n      \r\n      alert(errorMessage);\r\n      setPreview(null); // Clear preview on error\r\n    } finally {\r\n      setUploading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"space-y-2\">\r\n      <label className=\"block font-dosis font-semibold\">{label}</label>\r\n      <div className=\"border-2 border-dashed border-gray-300 rounded-lg p-4 text-center\">\r\n        {(preview || currentImage) && (\r\n          <img\r\n            src={preview || currentImage}\r\n            alt=\"Preview\"\r\n            className=\"max-w-full h-48 object-cover mx-auto mb-2 rounded\"\r\n          />\r\n        )}\r\n        <input\r\n          ref={fileInputRef}\r\n          type=\"file\"\r\n          accept=\"image/*\"\r\n          onChange={handleFileChange}\r\n          disabled={uploading}\r\n          className=\"hidden\"\r\n          id={inputId.current}\r\n        />\r\n        <label\r\n          htmlFor={inputId.current}\r\n          className={`cursor-pointer inline-block px-4 py-2 rounded-lg font-dosis font-semibold transition-colors ${\r\n            uploading\r\n              ? 'bg-gray-400 text-white cursor-not-allowed'\r\n              : 'bg-reshow-red text-white hover:bg-reshow-dark-red'\r\n          }`}\r\n        >\r\n          {uploading ? 'Uploading...' : preview || currentImage ? 'Change Image' : 'Choose Image'}\r\n        </label>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ImageUpload;\r\n\r\n"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,QAAQ,EAAEC,MAAM,QAAQ,OAAO;AAC/C,OAAOC,GAAG,MAAM,cAAc;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAE/B,MAAMC,WAAW,GAAGA,CAAC;EAAEC,YAAY;EAAEC,aAAa;EAAEC,KAAK,GAAG;AAAe,CAAC,KAAK;EAAAC,EAAA;EAC/E,MAAM,CAACC,SAAS,EAAEC,YAAY,CAAC,GAAGX,QAAQ,CAAC,KAAK,CAAC;EACjD,MAAM,CAACY,OAAO,EAAEC,UAAU,CAAC,GAAGb,QAAQ,CAAC,IAAI,CAAC;EAC5C,MAAMc,YAAY,GAAGb,MAAM,CAAC,IAAI,CAAC;EACjC,MAAMc,OAAO,GAAGd,MAAM,CAAC,gBAAgBe,IAAI,CAACC,GAAG,CAAC,CAAC,IAAIC,IAAI,CAACC,MAAM,CAAC,CAAC,CAACC,QAAQ,CAAC,EAAE,CAAC,CAACC,MAAM,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC;EAE/F,MAAMC,gBAAgB,GAAG,MAAOC,CAAC,IAAK;IACpC,MAAMC,IAAI,GAAGD,CAAC,CAACE,MAAM,CAACC,KAAK,CAAC,CAAC,CAAC;IAC9B,IAAI,CAACF,IAAI,EAAE;;IAEX;IACA,MAAMG,MAAM,GAAG,IAAIC,UAAU,CAAC,CAAC;IAC/BD,MAAM,CAACE,SAAS,GAAG,MAAM;MACvBhB,UAAU,CAACc,MAAM,CAACG,MAAM,CAAC;IAC3B,CAAC;IACDH,MAAM,CAACI,aAAa,CAACP,IAAI,CAAC;;IAE1B;IACAb,YAAY,CAAC,IAAI,CAAC;IAElB,IAAI;MACF;MACA,MAAMqB,cAAc,GAAG,IAAIC,QAAQ,CAAC,CAAC;MACrCD,cAAc,CAACE,MAAM,CAAC,OAAO,EAAEV,IAAI,CAAC;MACpCQ,cAAc,CAACE,MAAM,CAAC,YAAY,EAAE,SAAS,CAAC;MAE9CC,OAAO,CAACC,GAAG,CAAC,kBAAkB,EAAEZ,IAAI,CAACa,IAAI,EAAE,OAAO,EAAEb,IAAI,CAACc,IAAI,EAAE,OAAO,EAAEd,IAAI,CAACe,IAAI,CAAC;;MAElF;MACA,MAAMC,GAAG,GAAG,MAAMtC,GAAG,CAACuC,IAAI,CAAC,eAAe,EAAET,cAAc,CAAC;MAE3D,IAAIQ,GAAG,CAACE,IAAI,IAAIF,GAAG,CAACE,IAAI,CAACC,GAAG,EAAE;QAC5BpC,aAAa,CAACiC,GAAG,CAACE,IAAI,CAACC,GAAG,CAAC;QAC3B;QACA,IAAI7B,YAAY,CAAC8B,OAAO,EAAE;UACxB9B,YAAY,CAAC8B,OAAO,CAACC,KAAK,GAAG,EAAE;QACjC;MACF,CAAC,MAAM;QACL,MAAM,IAAIC,KAAK,CAAC,oBAAoB,CAAC;MACvC;IACF,CAAC,CAAC,OAAOC,KAAK,EAAE;MAAA,IAAAC,eAAA,EAAAC,gBAAA,EAAAC,gBAAA,EAAAC,qBAAA,EAAAC,gBAAA,EAAAC,gBAAA;MACdlB,OAAO,CAACY,KAAK,CAAC,qBAAqB,EAAEA,KAAK,CAAC;MAC3CZ,OAAO,CAACY,KAAK,CAAC,iBAAiB,GAAAC,eAAA,GAAED,KAAK,CAACO,QAAQ,cAAAN,eAAA,uBAAdA,eAAA,CAAgBN,IAAI,CAAC;MACtDP,OAAO,CAACY,KAAK,CAAC,eAAe,GAAAE,gBAAA,GAAEF,KAAK,CAACO,QAAQ,cAAAL,gBAAA,uBAAdA,gBAAA,CAAgBM,MAAM,CAAC;MACtDpB,OAAO,CAACY,KAAK,CAAC,gBAAgB,EAAEA,KAAK,CAACS,OAAO,CAAC;MAE9C,IAAIC,YAAY,GAAG,2CAA2C;MAC9D,KAAAP,gBAAA,GAAIH,KAAK,CAACO,QAAQ,cAAAJ,gBAAA,gBAAAC,qBAAA,GAAdD,gBAAA,CAAgBR,IAAI,cAAAS,qBAAA,eAApBA,qBAAA,CAAsBJ,KAAK,EAAE;QAC/BU,YAAY,GAAGV,KAAK,CAACO,QAAQ,CAACZ,IAAI,CAACK,KAAK;MAC1C,CAAC,MAAM,IAAI,EAAAK,gBAAA,GAAAL,KAAK,CAACO,QAAQ,cAAAF,gBAAA,uBAAdA,gBAAA,CAAgBG,MAAM,MAAK,GAAG,EAAE;QACzCE,YAAY,GAAG,6CAA6C;MAC9D,CAAC,MAAM,IAAI,EAAAJ,gBAAA,GAAAN,KAAK,CAACO,QAAQ,cAAAD,gBAAA,uBAAdA,gBAAA,CAAgBE,MAAM,MAAK,GAAG,EAAE;QAAA,IAAAG,oBAAA;QACzCD,YAAY,GAAG,EAAAC,oBAAA,GAAAX,KAAK,CAACO,QAAQ,CAACZ,IAAI,cAAAgB,oBAAA,uBAAnBA,oBAAA,CAAqBX,KAAK,KAAI,sDAAsD;MACrG,CAAC,MAAM,IAAIA,KAAK,CAACS,OAAO,EAAE;QACxBC,YAAY,GAAGV,KAAK,CAACS,OAAO;MAC9B;MAEAG,KAAK,CAACF,YAAY,CAAC;MACnB5C,UAAU,CAAC,IAAI,CAAC,CAAC,CAAC;IACpB,CAAC,SAAS;MACRF,YAAY,CAAC,KAAK,CAAC;IACrB;EACF,CAAC;EAED,oBACEP,OAAA;IAAKwD,SAAS,EAAC,WAAW;IAAAC,QAAA,gBACxBzD,OAAA;MAAOwD,SAAS,EAAC,gCAAgC;MAAAC,QAAA,EAAErD;IAAK;MAAAsD,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAQ,CAAC,eACjE7D,OAAA;MAAKwD,SAAS,EAAC,mEAAmE;MAAAC,QAAA,GAC/E,CAACjD,OAAO,IAAIN,YAAY,kBACvBF,OAAA;QACE8D,GAAG,EAAEtD,OAAO,IAAIN,YAAa;QAC7B6D,GAAG,EAAC,SAAS;QACbP,SAAS,EAAC;MAAmD;QAAAE,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAC9D,CACF,eACD7D,OAAA;QACEgE,GAAG,EAAEtD,YAAa;QAClByB,IAAI,EAAC,MAAM;QACX8B,MAAM,EAAC,SAAS;QAChBC,QAAQ,EAAEhD,gBAAiB;QAC3BiD,QAAQ,EAAE7D,SAAU;QACpBkD,SAAS,EAAC,QAAQ;QAClBY,EAAE,EAAEzD,OAAO,CAAC6B;MAAQ;QAAAkB,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACrB,CAAC,eACF7D,OAAA;QACEqE,OAAO,EAAE1D,OAAO,CAAC6B,OAAQ;QACzBgB,SAAS,EAAE,+FACTlD,SAAS,GACL,2CAA2C,GAC3C,mDAAmD,EACtD;QAAAmD,QAAA,EAEFnD,SAAS,GAAG,cAAc,GAAGE,OAAO,IAAIN,YAAY,GAAG,cAAc,GAAG;MAAc;QAAAwD,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAClF,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACL,CAAC;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACH,CAAC;AAEV,CAAC;AAACxD,EAAA,CAjGIJ,WAAW;AAAAqE,EAAA,GAAXrE,WAAW;AAmGjB,eAAeA,WAAW;AAAC,IAAAqE,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}